<fxt-dropdown-invite-user [authProvider]="authProvider" (addSingleUserClicked)="addOrEditUser()"
  (importMultipleUserClicked)="importMultipleUser()"
  (importDirectoryClicked)="importMicrosoftDirectory()">
</fxt-dropdown-invite-user>

<ngx-datatable class="bootstrap striped" [rows]="rows" [columnMode]="ColumnMode.force" [headerHeight]="50"
  [footerHeight]="50" [rowHeight]="45" [externalPaging]="true" [count]="page.totalCount" [offset]="page.pageNumber"
  [limit]="page.pageSize" (page)="setPage($event, oldSortProp, oldSortOrder)" [loadingIndicator]="loading"
  [externalSorting]="true" (sort)="onSort($event)">
  <ngx-datatable-column *ngFor="let column of columns" [name]="column.name | transloco" [prop]="column.prop"
    [pipe]="column.pipe" [sortable]="column.sortable" [cellTemplate]="column.cellTemplate"
    [cellClass]="column.cellClass" [headerClass]="column.headerClass">
  </ngx-datatable-column>

  <ngx-datatable-column name="action" [sortable]="false" [canAutoResize]="false" [draggable]="false"
    [resizeable]="false" cellClass="column-actions" *ngIf="canEdit">
    <ng-template ngx-datatable-header-template> </ng-template>
    <ng-template let-row="row" ngx-datatable-cell-template>
      <div>
        <div [tooltip]="'directory.edit_info' | transloco" container="body" (click)="edit(row)"
          class="btn btn-rounded-action">
          <i class="far fa-pencil"></i>
        </div>
        <div [tooltip]="'directory.archive_user' | transloco" container="body" (click)="archive(row)"
          class="btn btn-rounded-action">
          <i class="far fa-archive"></i>
        </div>
      </div>
    </ng-template>
  </ngx-datatable-column>

</ngx-datatable>

<div class="button-actions-wrapper mt-2" *ngIf="canEdit">
  <span (click)="getExcelUsers()" class="btn-export-xls"><i
      class="far fa-download"></i>&nbsp;{{'organization.xls_export_users' | transloco}}</span>
</div>

<ng-template #avatarTmp let-row="row" let-value="value">
  <fxt-avatar [tooltip]="'directory.click_to_open_profile' | transloco" container="body"
    (click)="openUserProfilePopup(row, $event)" [imageSrc]="row.tinyPicture" [initial]="row.fullName" [size]="32">
  </fxt-avatar>
</ng-template>

<ng-template #fullNameTmp let-row="row" let-value="value">
  <span (click)="openUserProfilePopup(row, $event)">{{row.firstName}} {{row.lastName}}</span>
</ng-template>

<ng-template #checkTmp let-row="row" let-value="value">
  <span *ngIf="value"><i class="fas fa-check"></i></span>
</ng-template>

<ng-template #dateTmp let-row="row" let-value="value">
  <span>{{value | date: formatDateTime }}</span>
</ng-template>

<ng-template #chipTmp let-row="row" let-value="value">
  <ng-container *ngIf="row.coreTeam">
    <fxt-chip [item]="{name: row.coreTeam, isHierarchy: true, type: 0}" [selected]="true">
    </fxt-chip>
  </ng-container>
</ng-template>